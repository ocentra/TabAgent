{"version":3,"file":"scriptingReadabilityHelper.js","mappings":"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","sources":["webpack://tabagent/./src/events/eventNames.ts","webpack://tabagent/webpack/bootstrap","webpack://tabagent/webpack/runtime/define property getters","webpack://tabagent/webpack/runtime/hasOwnProperty shorthand","webpack://tabagent/webpack/runtime/make namespace object","webpack://tabagent/./src/scriptingReadabilityHelper.ts"],"sourcesContent":["export const UIEventNames = Object.freeze({\n  QUERY_SUBMITTED: 'querySubmitted',\n  BACKGROUND_RESPONSE_RECEIVED: 'background:responseReceived',\n  BACKGROUND_ERROR_RECEIVED: 'background:errorReceived',\n  BACKGROUND_SCRAPE_STAGE_RESULT: 'background:scrapeStageResult',\n  BACKGROUND_SCRAPE_RESULT_RECEIVED: 'background:scrapeResultReceived',\n  BACKGROUND_LOADING_STATUS_UPDATE: 'ui:loadingStatusUpdate',\n  REQUEST_MODEL_LOAD: 'ui:requestModelLoad',\n  WORKER_READY: 'worker:ready',\n  WORKER_ERROR: 'worker:error',\n  NAVIGATION_PAGE_CHANGED: 'navigation:pageChanged',\n  SCRAPE_PAGE: 'SCRAPE_PAGE',\n  SCRAPE_ACTIVE_TAB: 'SCRAPE_ACTIVE_TAB',\n  DYNAMIC_SCRIPT_MESSAGE_TYPE: 'offscreenIframeResult',\n  MODEL_DOWNLOAD_PROGRESS: 'modelDownloadProgress',\n\n  MODEL_WORKER_LOADING_PROGRESS: 'modelWorkerLoadingProgress', // For when the worker itself is loading the model (pipeline init)\n  MODEL_SELECTION_CHANGED: 'ui:modelSelectionChanged', // When model or ONNX variant dropdown changes\n  REQUEST_MODEL_DOWNLOAD_ACTION: 'ui:requestModelDownloadAction', // When user clicks \"Download Model\" button\n  REQUEST_MODEL_EXECUTION: 'ui:requestModelExecution', // When user clicks \"Load Model\" button (to load into worker)\n  WORKER_STATE_CHANGED: 'worker:stateChanged', // Generic event for worker state updates (ready, error, etc.)\n});\n\nexport const WorkerEventNames = Object.freeze({\n  WORKER_SCRIPT_READY: 'workerScriptReady',\n  WORKER_READY: 'workerReady',\n  LOADING_STATUS: 'loadingStatus',\n  GENERATION_STATUS: 'generationStatus',\n  GENERATION_UPDATE: 'generationUpdate',\n  GENERATION_COMPLETE: 'generationComplete',\n  GENERATION_ERROR: 'generationError',\n  RESET_COMPLETE: 'resetComplete',\n  ERROR: 'error',\n  UNINITIALIZED: 'uninitialized',\n  CREATING_WORKER: 'creating_worker',\n  LOADING_MODEL: 'loading_model',\n  MODEL_READY: 'model_ready',\n  GENERATING: 'generating',\n  IDLE: 'idle',\n  WORKER_ENV_READY: 'workerEnvReady',\n  INIT: 'init',\n  GENERATE: 'generate',\n  RESET: 'reset',\n  SET_BASE_URL: 'setBaseUrl',\n  SET_ENV_CONFIG: 'setEnvConfig',\n});\n\nexport const ModelWorkerStates = Object.freeze({\n  UNINITIALIZED: 'uninitialized',\n  CREATING_WORKER: 'creating_worker',\n  WORKER_SCRIPT_READY: 'worker_script_ready',\n  LOADING_MODEL: 'loading_model',\n  MODEL_READY: 'model_ready',\n  GENERATING: 'generating',\n  ERROR: 'error',\n  IDLE: 'idle',\n  \n});\n\nexport const RuntimeMessageTypes = Object.freeze({\n  LOAD_MODEL: 'loadModel',\n  SEND_CHAT_MESSAGE: 'sendChatMessage',\n  INTERRUPT_GENERATION: 'interruptGeneration',\n  RESET_WORKER: 'resetWorker',\n  GET_MODEL_WORKER_STATE: 'getModelWorkerState',\n  SCRAPE_REQUEST: 'scrapeRequest',\n  GET_DRIVE_FILE_LIST: 'getDriveFileList',\n  GET_LOG_SESSIONS: 'getLogSessions',\n  GET_LOG_ENTRIES: 'getLogEntries',\n  DETACH_SIDE_PANEL: 'detachSidePanel',\n  GET_DETACHED_STATE: 'getDetachedState',\n  GET_DB_READY_STATE: 'getDbReadyState',\n});\n\nexport const SiteMapperMessageTypes = Object.freeze({\n  OPEN_TAB: 'openTab',\n  MAPPED: 'mapped',\n});\n\nexport const ModelLoaderMessageTypes = Object.freeze({\n  INIT: 'init',\n  GENERATE: 'Generate',\n  INTERRUPT: 'Interrupt',\n  RESET: 'Reset',\n  DOWNLOAD_MODEL_ASSETS: 'DownloadModelAssets',\n  LIST_MODEL_FILES: 'ListModelFiles',\n  LIST_MODEL_FILES_RESULT: 'ListModelFilesResult',\n});\n\nexport const InternalEventBusMessageTypes = Object.freeze({\n  BACKGROUND_EVENT_BROADCAST: 'BackgroundEventBroadcast'\n});\n\nexport const RawDirectMessageTypes = Object.freeze({\n  WORKER_GENERIC_RESPONSE: 'WorkerGenericResponse',\n  WORKER_GENERIC_ERROR: 'WorkerGenericError',\n  WORKER_SCRAPE_STAGE_RESULT: 'WorkerScrapeStageResult',\n  WORKER_DIRECT_SCRAPE_RESULT: 'WorkerDirectScrapeResult',\n  WORKER_UI_LOADING_STATUS_UPDATE: 'UiLoadingStatusUpdate' // This one is used as a direct message type\n});\n\nexport const Contexts = Object.freeze({\n  BACKGROUND: 'Background',\n  MAIN_UI: 'MainUI',\n  POPUP: 'Popup',\n  OTHERS: 'Others',\n  UNKNOWN: 'Unknown',\n});\n\nexport const MessageSenderTypes = Object.freeze({\n  USER: 'user',\n  SYSTEM: 'system',\n  AI: 'ai',\n  AGENT: 'agent',\n  // Add more as needed\n});\n\nexport const MessageContentTypes = Object.freeze({\n  TEXT: 'text',\n  IMAGE: 'image',\n  FILE: 'file',\n  CODE: 'code',\n  AGENT_ACTION: 'agent_action',\n  // Add more as needed\n});\n\nexport const TableNames = Object.freeze({\n  CHATS: 'chats',\n  MESSAGES: 'messages',\n  CHAT_SUMMARIES: 'chat_summaries',\n  ATTACHMENTS: 'attachments',\n  USERS: 'users',\n  LOGS: 'logs',\n  MODEL_ASSETS: 'model_assets',\n  KNOWLEDGE_GRAPH_NODES: 'knowledge_graph_nodes',\n  KNOWLEDGE_GRAPH_EDGES: 'knowledge_graph_edges',\n});\n\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { Contexts } from './events/eventNames';\nwindow.EXTENSION_CONTEXT = Contexts.OTHERS;\n// DO NOT use import statements here - they won't work in scripts injected via registerContentScripts.\n// Readability should be globally available because Readability.js is injected first.\n\ndeclare var Readability: any;\n\n(function() {\n    // This must match eventNames.js UIEventNames.DYNAMIC_SCRIPT_MESSAGE_TYPE\n    const DYNAMIC_SCRIPT_MESSAGE_TYPE = 'offscreenIframeResult';\n    // Polyfill for browser API if only chrome is available\n    const browser = typeof (window as any).browser !== 'undefined' ? (window as any).browser : (typeof (window as any).chrome !== 'undefined' ? (window as any).chrome : undefined);\n    console.log('[Dynamic Script Helper] Running in iframe...');\n\n    let result: any = { success: false, source: 'dynamic-script-helper' };\n\n    const runReadabilityAndSend = () => {\n        try {\n            if (typeof Readability === 'undefined') {\n                throw new Error('Readability library not found in iframe context.');\n            }\n\n            const article = new Readability(document).parse();\n            result = {\n                success: true,\n                source: 'dynamic-script-helper',\n                title: article ? article.title : '',\n                textContent: article ? article.textContent : '',\n                content: article ? article.content : '',\n                byline: article ? article.byline : '',\n                length: article ? article.length : 0,\n                excerpt: article ? article.excerpt : '',\n                siteName: article ? article.siteName : ''\n            };\n            console.log('[Dynamic Script Helper] Readability parsing successful.');\n        } catch (e: any) {\n            console.error('[Dynamic Script Helper] Error:', e);\n            result.error = e.message || 'Unknown error in dynamic script helper';\n        }\n        console.log('[Dynamic Script Helper] Sending result back to background:', result);\n        browser.runtime.sendMessage({ type: DYNAMIC_SCRIPT_MESSAGE_TYPE, payload: result });\n    };\n\n    if (document.readyState === 'complete' || document.readyState === 'interactive') {\n         console.log('[Dynamic Script Helper] Document already ready. Running Readability...');\n         runReadabilityAndSend();\n    } else {\n         console.log('[Dynamic Script Helper] Document not ready. Adding load listener...');\n         window.addEventListener('load', () => {\n              console.log('[Dynamic Script Helper] Window load event fired. Running Readability...');\n              runReadabilityAndSend();\n         }, { once: true });\n    }\n\n})(); "],"names":[],"sourceRoot":""}